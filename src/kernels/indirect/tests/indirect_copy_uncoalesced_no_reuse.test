#include <kernels/indirect/tests/indirect_copy.htest>

#if __CUDA_ARCH__ > 800
    #define SHUFFLE_SIZE_NO_REUSE 4194304 // 2^22   (*8B = 32MB)
#elif __CUDA_ARCH__ > 700
    #define SHUFFLE_SIZE_NO_REUSE 524288  // 2^19   (*8B = 4MB)
#else
    #define SHUFFLE_SIZE_NO_REUSE 131072  // 2^17   (*8B = 1MB)
#endif
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 1, UNCOALESCED_SHUFFLESZ);
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 1, UNCOALESCED_SHUFFLESZ_NO_BANK_CONFLICTS);
   
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 2, UNCOALESCED_SHUFFLESZ);
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 2, UNCOALESCED_SHUFFLESZ_NO_BANK_CONFLICTS);

    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 4, UNCOALESCED_SHUFFLESZ);
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 4, UNCOALESCED_SHUFFLESZ_NO_BANK_CONFLICTS);

    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 8, UNCOALESCED_SHUFFLESZ);
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 8, UNCOALESCED_SHUFFLESZ_NO_BANK_CONFLICTS);


    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 1, SECTOR_BASED_UNCOALESCED_SHUFFLESZ);
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 1, SECTOR_BASED_UNCOALESCED_SHUFFLESZ_NO_BANK_CONFLICTS);
   
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 2, SECTOR_BASED_UNCOALESCED_SHUFFLESZ);
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 2, SECTOR_BASED_UNCOALESCED_SHUFFLESZ_NO_BANK_CONFLICTS);

    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 4, SECTOR_BASED_UNCOALESCED_SHUFFLESZ);
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 4, SECTOR_BASED_UNCOALESCED_SHUFFLESZ_NO_BANK_CONFLICTS);

    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 8, SECTOR_BASED_UNCOALESCED_SHUFFLESZ);
    INDIRECT_COPY(SHUFFLE_SIZE_NO_REUSE, 8, SECTOR_BASED_UNCOALESCED_SHUFFLESZ_NO_BANK_CONFLICTS);
